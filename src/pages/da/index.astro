---
import Layout from '../../layouts/Layout.astro';
import { t } from '../../i18n/index.ts';
import AIBrain from '../../components/AIBrain.astro';
import IconArrowRight from '../../components/icons/IconArrowRight.astro';
import IconExternal from '../../components/icons/IconExternal.astro';
import IconPhone from '../../components/icons/IconPhone.astro';
import IconLinkedIn from '../../components/icons/IconLinkedIn.astro';
import IconLocation from '../../components/icons/IconLocation.astro';

const lang = 'da';  // Hardcode for Danish pages
const prefix = '/da';  // Hardcode for Danish pages
---

<Layout title={t('meta.homeTitle', lang)} description={t('meta.homeDescription', lang)} lang={lang}>
  <!-- Hero Section -->
  <section class="hero section bg-hero-neural" id="hero">
    <div class="container">
      <div class="hero-content">
        <div class="hero-text">
          <span class="hero-tagline">{t('hero.tagline', lang)}</span>
          <h1 class="hero-title">
            {t('hero.title', lang)}
            <span class="text-gradient glitch" data-text="Vibecoding">Vibecoding</span>
          </h1>
          <p class="hero-description">{t('hero.description', lang)}</p>
          <div class="hero-buttons">
            <a href={`${prefix}/contact`} class="btn btn-primary btn-glow">
              {t('hero.cta', lang)}
              <IconArrowRight />
            </a>
            <a href={`${prefix}/portfolio`} class="btn btn-secondary">
              {t('hero.secondary', lang)}
            </a>
          </div>
        </div>
        <div class="hero-visual">
          <AIBrain />
        </div>
      </div>
    </div>
  </section>

  <!-- Services Marquee -->
  <div class="marquee section-sm">
    <div class="marquee-content">
      <span>Vibecoding</span>
      <span>{t('services.aiConsulting', lang)}</span>
      <span>SEO</span>
      <span>Google Ads</span>
      <span>Meta {t('services.advertising', lang)}</span>
      <span>{t('services.webDesign', lang)}</span>
      <span>GTM</span>
      <span>Workshops</span>
      <span>Vibecoding</span>
      <span>{t('services.aiConsulting', lang)}</span>
      <span>SEO</span>
      <span>Google Ads</span>
      <span>Meta {t('services.advertising', lang)}</span>
      <span>{t('services.webDesign', lang)}</span>
      <span>GTM</span>
      <span>Workshops</span>
    </div>
  </div>

  <!-- Core Services Section -->
  <section class="section" id="services">
    <div class="container">
      <div class="text-center mb-3">
        <span class="hero-tagline">{t('services.whatWeDo', lang)}</span>
        <h2>{t('services.title', lang)}</h2>
        <p style="max-width: 600px; margin: 0 auto;">{t('services.subtitle', lang)}</p>
      </div>

      <div class="services-grid stagger reveal">
        <!-- Vibecoding -->
        <div class="card service-card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-vibecoding.webp" alt="Vibecoding" loading="lazy" />
          </div>
          <h3 class="card-title">Vibecoding</h3>
          <p class="card-text">{t('services.vibecoding', lang)}</p>
          <a href={`${prefix}/vibecoding`} class="btn btn-secondary mt-1">
            {t('common.learnMore', lang)}
          </a>
        </div>

        <!-- AI Consulting -->
        <div class="card service-card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-ai-consulting.webp" alt="AI-rådgivning" loading="lazy" />
          </div>
          <h3 class="card-title">{t('services.aiConsulting', lang)}</h3>
          <p class="card-text">{t('services.aiConsultingDesc', lang)}</p>
          <a href={`${prefix}/ai-consulting`} class="btn btn-secondary mt-1">
            {t('common.learnMore', lang)}
          </a>
        </div>

        <!-- Workshops -->
        <div class="card service-card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-workshops.webp" alt="AI-workshops" loading="lazy" />
          </div>
          <h3 class="card-title">{t('services.workshops', lang)}</h3>
          <p class="card-text">{t('services.workshopsDesc', lang)}</p>
          <a href={`${prefix}/workshops`} class="btn btn-secondary mt-1">
            {t('common.learnMore', lang)}
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Digital Marketing Section -->
  <section class="section bg-marketing">
    <div class="container">
      <div class="text-center mb-3">
        <span class="hero-tagline">{t('marketing.tagline', lang)}</span>
        <h2>15+ {t('marketing.yearsOf', lang)} <span class="text-gradient">{t('marketing.expertise', lang)}</span></h2>
        <p style="max-width: 600px; margin: 0 auto;">{t('marketing.subtitle', lang)}</p>
      </div>

      <div class="services-grid stagger reveal">
        <!-- SEO -->
        <div class="card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-seo.webp" alt="SEO" loading="lazy" />
          </div>
          <h4 class="card-title">SEO</h4>
          <p class="card-text">{t('marketing.seo', lang)}</p>
          <a href={`${prefix}/seo`}>{t('common.learnMore', lang)} →</a>
        </div>

        <!-- Google Ads -->
        <div class="card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-google-ads.webp" alt="Google Ads" loading="lazy" />
          </div>
          <h4 class="card-title">Google Ads</h4>
          <p class="card-text">{t('marketing.googleAds', lang)}</p>
          <a href={`${prefix}/google-ads`}>{t('common.learnMore', lang)} →</a>
        </div>

        <!-- Meta Advertising -->
        <div class="card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-meta-ads.webp" alt="Meta-annoncering" loading="lazy" />
          </div>
          <h4 class="card-title">{t('nav.metaAds', lang)}</h4>
          <p class="card-text">{t('marketing.metaAds', lang)}</p>
          <a href={`${prefix}/meta-advertising`}>{t('common.learnMore', lang)} →</a>
        </div>

        <!-- Web Design -->
        <div class="card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-webdesign.webp" alt="Webdesign" loading="lazy" />
          </div>
          <h4 class="card-title">{t('nav.webdesign', lang)}</h4>
          <p class="card-text">{t('marketing.webDesign', lang)}</p>
          <a href={`${prefix}/webdesign`}>{t('common.learnMore', lang)} →</a>
        </div>

        <!-- Google Tag Manager -->
        <div class="card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-gtm.webp" alt="Google Tag Manager" loading="lazy" />
          </div>
          <h4 class="card-title">Google Tag Manager</h4>
          <p class="card-text">{t('marketing.gtm', lang)}</p>
          <a href={`${prefix}/google-tag-manager`}>{t('common.learnMore', lang)} →</a>
        </div>

        <!-- Analytics -->
        <div class="card">
          <div class="card-icon card-icon-image">
            <img src="/images/icon-analytics.webp" alt="Analyse" loading="lazy" />
          </div>
          <h4 class="card-title">{t('marketing.analytics', lang)}</h4>
          <p class="card-text">{t('marketing.analyticsDesc', lang)}</p>
          <a href={`${prefix}/contact`}>{t('common.learnMore', lang)} →</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Stats Section -->
  <section class="section section-mesh bg-stats">
    <div class="container">
      <div class="stats-grid reveal">
        <div class="stat-item">
          <div class="stat-number">15+</div>
          <div class="stat-label">{t('stats.years', lang)}</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">100+</div>
          <div class="stat-label">{t('stats.projects', lang)}</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">10x</div>
          <div class="stat-label">{t('stats.faster', lang)}</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">24/7</div>
          <div class="stat-label">{t('stats.support', lang)}</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Portfolio Showcase -->
  <section class="section bg-portfolio" id="portfolio">
    <div class="container">
      <div class="text-center mb-3">
        <span class="hero-tagline">{t('portfolio.tagline', lang)}</span>
        <h2>{t('portfolio.featured', lang)} <span class="text-gradient">{t('portfolio.projects', lang)}</span></h2>
        <p style="max-width: 600px; margin: 0 auto;">{t('portfolio.subtitle', lang)}</p>
      </div>

      <div class="showcase-grid reveal">
        <!-- WELC -->
        <div class="showcase-item">
          <img class="showcase-image" src="/images/portfolio-crypto.webp" alt="WeLoveEverythingCrypto" loading="lazy" />
          <div class="showcase-overlay">
            <span class="showcase-tag">{t('portfolio.liveProject', lang)}</span>
            <h3 class="showcase-title">WeLoveEverythingCrypto</h3>
            <p>{t('portfolio.welcDesc', lang)}</p>
            <a href="https://weloveeverythingcrypto.com" target="_blank" rel="noopener" class="btn btn-primary">
              {t('portfolio.visitSite', lang)} <IconExternal />
            </a>
          </div>
        </div>

        <!-- Handball Stats -->
        <div class="showcase-item">
          <img class="showcase-image" src="/images/portfolio-handball.webp" alt="Handball Tracker" loading="lazy" />
          <div class="showcase-overlay">
            <span class="showcase-tag">{t('portfolio.liveProject', lang)}</span>
            <h3 class="showcase-title">Handball Tracker</h3>
            <p>{t('portfolio.handballDesc', lang)}</p>
            <a href="https://handballtracker.com" target="_blank" rel="noopener" class="btn btn-primary">
              {t('portfolio.visitSite', lang)} <IconExternal />
            </a>
          </div>
        </div>

        <!-- Let Me Claude That For You -->
        <div class="showcase-item">
          <img class="showcase-image" src="/images/portfolio-lmctfy.svg" alt="Let Me Claude That For You" loading="lazy" />
          <div class="showcase-overlay">
            <span class="showcase-tag">{t('portfolio.liveProject', lang)}</span>
            <h3 class="showcase-title">Let Me Claude That For You</h3>
            <p>{t('portfolio.lmctfyDesc', lang)}</p>
            <a href="https://letmeclaudethatforyou.live" target="_blank" rel="noopener" class="btn btn-primary">
              {t('portfolio.visitSite', lang)} <IconExternal />
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Process Section -->
  <section class="section bg-geometric">
    <div class="container">
      <div class="text-center mb-3">
        <span class="hero-tagline">{t('process.tagline', lang)}</span>
        <h2>{t('process.the', lang)} <span class="text-gradient">Vibecoding</span>{t('process.process', lang)}</h2>
      </div>

      <div class="process-grid reveal">
        <div class="process-step">
          <div class="process-number">1</div>
          <h4 class="process-title">{t('process.discovery', lang)}</h4>
          <p class="process-text">{t('process.discoveryDesc', lang)}</p>
        </div>
        <div class="process-step">
          <div class="process-number">2</div>
          <h4 class="process-title">{t('process.design', lang)}</h4>
          <p class="process-text">{t('process.designDesc', lang)}</p>
        </div>
        <div class="process-step">
          <div class="process-number">3</div>
          <h4 class="process-title">{t('process.develop', lang)}</h4>
          <p class="process-text">{t('process.developDesc', lang)}</p>
        </div>
        <div class="process-step">
          <div class="process-number">4</div>
          <h4 class="process-title">{t('process.deploy', lang)}</h4>
          <p class="process-text">{t('process.deployDesc', lang)}</p>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta-section">
    <div class="cta-orb cta-orb-1"></div>
    <div class="cta-orb cta-orb-2"></div>
    <div class="cta-orb cta-orb-3"></div>
    <div class="container">
      <div class="cta-card">
        <h2>{t('cta.title', lang)}</h2>
        <p>{t('cta.subtitle', lang)}</p>
        <div class="cta-buttons">
          <a href={`${prefix}/contact`} class="btn btn-primary btn-glow">
            {t('cta.button', lang)}
            <IconArrowRight />
          </a>
          <a href="tel:+4550587900" class="btn btn-secondary">
            <IconPhone />
            +45 50 58 79 00
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section class="section bg-marketing" id="contact">
    <div class="container">
      <div class="contact-grid">
        <div class="contact-info reveal-left">
          <span class="hero-tagline">{t('contact.tagline', lang)}</span>
          <h2>{t('contact.title', lang)} <span class="text-gradient">{t('contact.amazing', lang)}</span></h2>
          <p>{t('contact.subtitle', lang)}</p>

          <div class="contact-item">
            <div class="contact-icon">
              <IconPhone />
            </div>
            <div>
              <strong>{t('contact.phone', lang)}</strong><br />
              <a href="tel:+4550587900">+45 50 58 79 00</a>
            </div>
          </div>

          <div class="contact-item">
            <div class="contact-icon">
              <IconLinkedIn />
            </div>
            <div>
              <strong>LinkedIn</strong><br />
              <a href="https://www.linkedin.com/in/kennethabueg/" target="_blank" rel="noopener">
                {t('contact.connectLinkedIn', lang)}
              </a>
            </div>
          </div>

          <div class="contact-item">
            <div class="contact-icon">
              <IconLocation />
            </div>
            <div>
              <strong>{t('contact.businessReg', lang)}</strong><br />
              CVR: DK39733730<br />
              {t('footer.denmark', lang)}
            </div>
          </div>
        </div>

        <div class="reveal-right">
          <form class="contact-form" id="contact-form"
            data-sending={t('contact.sending', lang)}
            data-success-title={t('contact.successTitle', lang)}
            data-success-msg={t('contact.successMessage', lang)}
            data-error-title={t('contact.errorTitle', lang)}
            data-error-msg={t('contact.errorMessage', lang)}
          >
            <div class="form-group">
              <label class="form-label" for="contact-name">{t('contact.name', lang)} *</label>
              <input type="text" id="contact-name" name="name" class="form-input" required />
            </div>

            <div class="form-group">
              <label class="form-label" for="contact-email">E-mail *</label>
              <input type="email" id="contact-email" name="email" class="form-input" required />
            </div>

            <div class="form-group">
              <label class="form-label" for="contact-phone">{t('contact.phone', lang)}</label>
              <input type="tel" id="contact-phone" name="phone" class="form-input" />
            </div>

            <div class="form-group">
              <label class="form-label" for="contact-service">{t('contact.serviceInterest', lang)}</label>
              <select id="contact-service" name="service" class="form-input form-select">
                <option value="">{t('contact.selectService', lang)}</option>
                <option value="vibecoding">Vibecoding</option>
                <option value="ai-consulting">{t('services.aiConsulting', lang)}</option>
                <option value="workshops">AI-workshops</option>
                <option value="seo">SEO</option>
                <option value="google-ads">Google Ads</option>
                <option value="meta-ads">{t('nav.metaAds', lang)}</option>
                <option value="webdesign">{t('nav.webdesign', lang)}</option>
                <option value="gtm">Google Tag Manager</option>
                <option value="other">{t('contact.other', lang)}</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="contact-message">{t('contact.message', lang)} *</label>
              <textarea id="contact-message" name="message" class="form-textarea" required placeholder={t('contact.messagePlaceholder', lang)}></textarea>
            </div>

            <!-- Honeypot anti-bot field — hidden from humans -->
            <div aria-hidden="true" style="position: absolute; left: -9999px; opacity: 0; height: 0; overflow: hidden;">
              <label for="website">Website</label>
              <input type="text" id="website" name="website" tabindex="-1" autocomplete="off" />
            </div>
            <input type="hidden" name="_t" id="form-timestamp" />

            <button type="submit" class="btn btn-primary w-full">
              <span class="btn-text">{t('contact.send', lang)}<IconArrowRight /></span>
            </button>

            <div id="form-status" class="form-status" style="display: none;"></div>
          </form>
        </div>
      </div>
    </div>
  </section>
</Layout>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const statusEl = document.getElementById('form-status') as HTMLDivElement;
  const timestampEl = document.getElementById('form-timestamp') as HTMLInputElement;

  if (timestampEl) timestampEl.value = String(Date.now());

  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const submitBtn = form.querySelector('button[type="submit"]') as HTMLButtonElement;
      const btnText = submitBtn.querySelector('.btn-text') as HTMLSpanElement;
      const originalHtml = btnText.innerHTML;
      submitBtn.disabled = true;
      btnText.textContent = form.dataset.sending || 'Sender...';
      statusEl.style.display = 'none';

      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const res = await fetch('/api/contact', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
        });

        if (res.ok) {
          statusEl.className = 'form-status form-status-success';
          statusEl.innerHTML = `<strong>${form.dataset.successTitle}</strong><p>${form.dataset.successMsg}</p>`;
          statusEl.style.display = 'block';
          form.reset();
          if (timestampEl) timestampEl.value = String(Date.now());
        } else {
          throw new Error('Request failed');
        }
      } catch {
        statusEl.className = 'form-status form-status-error';
        statusEl.innerHTML = `<strong>${form.dataset.errorTitle}</strong><p>${form.dataset.errorMsg}</p>`;
        statusEl.style.display = 'block';
      } finally {
        submitBtn.disabled = false;
        btnText.innerHTML = originalHtml;
      }
    });
  }
</script>
